{"version":3,"sources":["../src/expressions.ts","../src/functions.ts","../src/operators.ts","../src/utilities.ts","../src/values.ts"],"names":["distinct","statement","sql","cases","conditionals","fallback","chunks","acc","curr","bindIfParam","StringChunk","coalesce","values","v","nullIf","value","condition","greatest","least","add","additions","SQL","subtract","subtractions","divide","divisions","multiply","multiplications","getColumns","table","is","Table","View","ViewBaseConfig","getNameOrAlias","query","Column","Subquery","Placeholder","paginate","qb","page","size","$true","$false","$boolean","$null","$currentTimestamp"],"mappings":"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","file":"chunk-LRBWF2CU.js","sourcesContent":["import type { SQL, SQLWrapper } from 'drizzle-orm';\nimport { StringChunk, bindIfParam, sql } from 'drizzle-orm';\nimport type { TupleToUnion } from 'type-fest';\nimport { type InferData } from '.';\nimport type { NonUndefinable } from './internals';\n\n/**\n * Distinct keyword.\n */\nexport function distinct<T extends SQLWrapper>(statement: T) {\n\treturn sql<InferData<T>>`distinct ${statement}`;\n}\n\n/**\n * Case condition chain.\n *\n * @example\n *\n * ```ts\n * cases([[eq(thing, other), 2]], 3);\n * ```\n *\n * @example\n *\n * ```sql\n * CASE\n *  WHEN thing = other THEN 2\n *  ELSE 3\n * END;\n * ```\n *\n * @todo Implement smarter typing to identify confirmable early returns with truthy conditions.\n */\nexport function cases<\n\tconst C extends ([SQLWrapper, unknown] | undefined)[],\n\tconst F,\n\tT = NonUndefinable<TupleToUnion<C>>,\n\tR =\n\t\t| (T extends [infer T0, infer T1]\n\t\t\t\t? T0 extends SQL<false | null | 0 | 'f' | 'F' | '0'>\n\t\t\t\t\t? never\n\t\t\t\t\t: T1 extends SQLWrapper\n\t\t\t\t\t\t? InferData<T1>\n\t\t\t\t\t\t: T1\n\t\t\t\t: never)\n\t\t| (F extends void ? never : F extends SQLWrapper ? InferData<F> : F),\n>(conditionals: C, fallback?: F) {\n\tconst chunks = conditionals.reduce(\n\t\t(acc, curr) => {\n\t\t\tif (curr) {\n\t\t\t\tacc.push(sql`when ${curr[0]} then ${bindIfParam(curr[1], curr[0])}`);\n\t\t\t}\n\t\t\treturn acc;\n\t\t},\n\t\t<SQL<unknown>[]>[]\n\t);\n\tif (fallback) {\n\t\tchunks.push(sql`else ${fallback}`);\n\t}\n\treturn sql.join(\n\t\t[new StringChunk('(case'), ...chunks, new StringChunk(')')],\n\t\tnew StringChunk(' ')\n\t) as SQL<R>;\n}\n","import type { SQL, SQLWrapper } from 'drizzle-orm';\nimport { StringChunk, sql } from 'drizzle-orm';\nimport type { InferData } from '.';\n\ntype RemoveNull<T> = T extends null ? never : T;\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\ntype CoalesceSQL<T extends unknown[], N extends boolean = true, R = never> = T extends [\n\tinfer H,\n\t...infer T,\n]\n\t? CoalesceSQL<\n\t\t\tT,\n\t\t\tH extends SQL | SQL.Aliased ? (null extends InferData<H> ? true : false) : never,\n\t\t\tR | RemoveNull<H extends SQL | SQL.Aliased ? InferData<H> : never>\n\t\t>\n\t: N extends true\n\t\t? R | null\n\t\t: R;\n/**\n * @see https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL\n */\nexport function coalesce<T extends unknown[]>(...values: [...T]) {\n\treturn sql<CoalesceSQL<T>>`coalesce(${sql.join(\n\t\tvalues.map((v) => sql`${v}`),\n\t\tsql`,`\n\t)})`;\n}\n\n/**\n * Return null if value meets condition. Useful to coalesce to something else.\n *\n * @see https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-NULLIF\n */\nexport function nullIf<V extends SQLWrapper, C>(value: V, condition: C) {\n\treturn sql<V | null>`nullif(${value}, ${condition})`;\n}\n\n/**\n * @see https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-GREATEST-LEAST\n */\nexport function greatest<T extends unknown[]>(...values: [...T]) {\n\treturn sql.join([\n\t\tnew StringChunk('greatest('),\n\t\tsql.join(\n\t\t\tvalues.map((v) => sql`${v}`),\n\t\t\tnew StringChunk(', ')\n\t\t),\n\t\tnew StringChunk(')'),\n\t]) as SQL<{ [I in keyof T]: T[I] extends SQLWrapper ? InferData<T[I]> : T[I] }[number]>;\n}\n\n/**\n * @see https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-GREATEST-LEAST\n */\nexport function least<T extends unknown[]>(...values: [...T]) {\n\treturn sql.join([\n\t\tnew StringChunk('least('),\n\t\tsql.join(\n\t\t\tvalues.map((v) => sql`${v}`),\n\t\t\tnew StringChunk(', ')\n\t\t),\n\t\tnew StringChunk(')'),\n\t]) as SQL<{ [I in keyof T]: T[I] extends SQLWrapper ? InferData<T[I]> : T[I] }[number]>;\n}\n","import { SQL, StringChunk, sql, type SQLWrapper } from 'drizzle-orm';\nimport type { InferData } from '.';\n\n/**\n * Add values.\n */\nexport function add<T extends (SQLWrapper | number)[]>(...values: T) {\n\tconst additions = sql.join(values, new StringChunk(' + '));\n\treturn new SQL([new StringChunk('('), additions, new StringChunk(')')]) as SQL<\n\t\tT[number] extends SQLWrapper ? InferData<T[number]> : T[number]\n\t>;\n}\n\n/**\n * Subtract values.\n */\nexport function subtract<T extends (SQLWrapper | number)[]>(...values: T) {\n\tconst subtractions = sql.join(values, new StringChunk(' - '));\n\treturn new SQL([new StringChunk('('), subtractions, new StringChunk(')')]) as SQL<\n\t\tT[number] extends SQLWrapper ? InferData<T[number]> : T[number]\n\t>;\n}\n\n/**\n * Divide values.\n */\nexport function divide<T extends (SQLWrapper | number)[]>(...values: T) {\n\tconst divisions = sql.join(values, new StringChunk(' / '));\n\treturn new SQL([new StringChunk('('), divisions, new StringChunk(')')]) as SQL<\n\t\tT[number] extends SQLWrapper ? InferData<T[number]> : T[number]\n\t>;\n}\n\n/**\n * Multiply values.\n */\nexport function multiply<T extends (SQLWrapper | number)[]>(...values: T) {\n\tconst multiplications = sql.join(values, new StringChunk(' * '));\n\treturn new SQL([new StringChunk('('), multiplications, new StringChunk(')')]) as SQL<\n\t\tT[number] extends SQLWrapper ? InferData<T[number]> : T[number]\n\t>;\n}\n","import {\n\tColumn,\n\tPlaceholder,\n\tSQL,\n\tSubquery,\n\tTable,\n\tView,\n\tViewBaseConfig,\n\tis,\n\ttype AnyColumn,\n\ttype ColumnBuilderBase,\n\ttype ColumnsSelection,\n\ttype InferSelectModel,\n\ttype SQLWrapper,\n\ttype WithSubquery,\n} from 'drizzle-orm';\nimport type {\n\tAnyMySqlSelect,\n\tMySqlSchema,\n\tMySqlSelect,\n\tSubqueryWithSelection as MySqlSubqueryWithSelection,\n\tWithSubqueryWithSelection as MySqlWithSubqueryWithSelection,\n} from 'drizzle-orm/mysql-core';\nimport type {\n\tAnyPgSelect,\n\tPgSchema,\n\tPgSelect,\n\tSubqueryWithSelection as PgSubqueryWithSelection,\n\tWithSubqueryWithSelection as PgWithSubqueryWithSelection,\n} from 'drizzle-orm/pg-core';\nimport type {\n\tAnySQLiteSelect,\n\tSQLiteSelect,\n\tSubqueryWithSelection as SQLiteSubqueryWithSelection,\n\tWithSubqueryWithSelection as SQLiteWithSubqueryWithSelection,\n} from 'drizzle-orm/sqlite-core';\nimport type { SetOptional } from 'type-fest';\n\n/**\n * Dialect agnostic select.\n *\n * @see PgSelect.\n * @see MySqlSelect\n * @see SQLiteSelect\n */\nexport type Select = SetOptional<PgSelect | MySqlSelect | SQLiteSelect, 'where'>;\n\n/**\n * Dialect-agnostic schema. Excludes SQLite.\n */\nexport type Schema = PgSchema | MySqlSchema;\n\n/**\n * Dialect-agnostic subquery with selection.\n */\nexport type SubqueryWithSelection<TSelection extends ColumnsSelection, TName extends string> =\n\t| MySqlSubqueryWithSelection<TSelection, TName>\n\t| PgSubqueryWithSelection<TSelection, TName>\n\t| SQLiteSubqueryWithSelection<TSelection, TName>;\n\n/**\n * Dialect-agnostic with subquery with selection.\n */\nexport type WithSubqueryWithSelection<TSelection extends ColumnsSelection, TAlias extends string> =\n\t| PgWithSubqueryWithSelection<TSelection, TAlias>\n\t| SQLiteWithSubqueryWithSelection<TSelection, TAlias>\n\t| MySqlWithSubqueryWithSelection<TSelection, TAlias>;\n\n/**\n * Dialect agnostic AnySelect.\n *\n * @see AnyPgSelect\n * @see AnyMySqlSelect\n * @see AnySQLiteSelect\n */\nexport type AnySelect = SetOptional<AnyPgSelect | AnyMySqlSelect | AnySQLiteSelect, 'where'>;\n\n/**\n * Infer type of table column.\n */\nexport type InferColumnType<T extends (...config: never[]) => ColumnBuilderBase> = AnyColumn<\n\tPick<ReturnType<T>['_'], 'data' | 'dataType'>\n>;\n\n/**\n * Infer any SQL wrapper's expected return data type.\n */\nexport type InferData<T extends SQLWrapper> = T extends Table\n\t? InferSelectModel<T>\n\t: T extends Column\n\t\t? T['_']['notNull'] extends true\n\t\t\t? T['_']['data']\n\t\t\t: T['_']['data'] | null\n\t\t: T extends View | Subquery\n\t\t\t? T['_']['selectedFields']\n\t\t\t: T extends SQL<infer U>\n\t\t\t\t? U\n\t\t\t\t: T extends SQL.Aliased<infer U>\n\t\t\t\t\t? U\n\t\t\t\t\t: unknown;\n\n/**\n * Infer table columns or (sub)query fields.\n */\nexport type InferColumns<T extends Table | View | Subquery | WithSubquery | AnySelect> =\n\tT extends Table\n\t\t? T['_']['columns']\n\t\t: T extends View | Subquery | WithSubquery | AnySelect\n\t\t\t? T['_']['selectedFields']\n\t\t\t: never;\n\n/**\n * Infer a table's name or a (sub)query's alias.\n */\nexport type InferNameOrAlias<T extends SQLWrapper> = T extends Table | View | Column\n\t? T['_']['name']\n\t: T extends Subquery | WithSubquery\n\t\t? T['_']['alias']\n\t\t: T extends AnySelect\n\t\t\t? T['_']['tableName']\n\t\t\t: T extends SQL.Aliased\n\t\t\t\t? T['fieldAlias']\n\t\t\t\t: T extends Placeholder\n\t\t\t\t\t? T['name']\n\t\t\t\t\t: undefined;\n\n/**\n * Should replace `getTableColumns` to allow for more input versatility.\n *\n * @see https://github.com/drizzle-team/drizzle-orm/pull/1789\n */\nexport function getColumns<\n\tT extends\n\t\t| Table\n\t\t| View\n\t\t| Subquery<string, ColumnsSelection>\n\t\t| WithSubquery<string, ColumnsSelection>\n\t\t| AnySelect,\n>(table: T): InferColumns<T> {\n\treturn is(table, Table)\n\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t(table as any)[(Table as any).Symbol.Columns]\n\t\t: is(table, View)\n\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t(table as any)[ViewBaseConfig].selectedFields\n\t\t\t: // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\ttable._.selectedFields;\n}\n\n/**\n * Get a table's name or a (sub)query's alias.\n */\nexport function getNameOrAlias<T extends SQLWrapper>(query: T): InferNameOrAlias<T> {\n\treturn is(query, Table)\n\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t(query as any)[(Table as any).Symbol.Name]\n\t\t: is(query, View)\n\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t(query as any)[ViewBaseConfig].name\n\t\t\t: is(query, Column)\n\t\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t(query.name as any)\n\t\t\t\t: is(query, Subquery)\n\t\t\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t(query._.alias as any)\n\t\t\t\t\t: is(query, SQL.Aliased)\n\t\t\t\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t(query.fieldAlias as any)\n\t\t\t\t\t\t: is(query, Placeholder)\n\t\t\t\t\t\t\t? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\t(query.name as any)\n\t\t\t\t\t\t\t: // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t\t\t\t\t(undefined as any);\n}\n\n/**\n * Paginate a query.\n */\nexport function paginate<T extends Select>(\n\tqb: T,\n\t{ page, size = 20 }: { page: number; size?: number }\n) {\n\treturn qb.limit(size).offset(page * size);\n}\n\n// /**\n//  * ...\n//  */\n// export function uuidDashless() {\n// \treturn sql`replace(uuid(), '-', '')`.mapWith(String);\n// }\n","import { sql } from 'drizzle-orm';\n\n/**\n * SQL template true value.\n */\nexport const $true = sql<true>`'true'`;\n\n/**\n * SQL template false value.\n */\nexport const $false = sql<false>`'false'`;\n\n/**\n * SQL template boolean value.\n */\nexport function $boolean<T extends boolean>(value: T) {\n\treturn sql<T>`${value ? 'true' : 'false'}`;\n}\n\n/**\n * SQL template null value.\n */\nexport const $null = sql<null>`null`;\n\n/**\n * @example\n *\n * ```sql\n * current_timestamp();\n * ```\n */\nexport const $currentTimestamp = sql<Date>`current_timestamp`;\n"]}